\usepackage[english]{babel}


\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{upgreek}
\usepackage{amsthm}
\usepackage{xfrac}
\usepackage{thmtools}
\usepackage[binary-units=true]{siunitx}


\usepackage[T1]{fontenc}
\usepackage{mathspec}

% undo the dumb changes made by mathspec
\makeatletter
\let\RequirePackage\original@RequirePackage
\let\usepackage\RequirePackage
\makeatother

\setmonofont[
  Contextuals={Alternate}
]{Fira Code}
\usepackage{newpxtext}
\usepackage{newpxmath}
\usepackage{epsdice}
\usepackage{microtype}
\usepackage[babel]{csquotes}
\MakeOuterQuote{"}


\usepackage{tikz}
\usetikzlibrary{shapes}


\usepackage[sc,bf]{titlesec}
\newcommand{\customchapterspacing}{-1.4ex}

\titleformat
  {\chapter}
  [display]
  {\normalfont\huge\scshape\bfseries}
  {\vspace{-20pt}}
  {0pt}
  {\Huge}
  [\vspace{\customchapterspacing}\rule{\textwidth}{0.3pt}]

  \titlespacing*
{\chapter}
{0pt}
{-20pt}
{10pt}


\usepackage[toc,page]{appendix}
\usepackage{abstract}
\renewcommand{\abstractnamefont}{\normalfont\LARGE\scshape\bfseries}
\setlength{\absleftindent}{25mm}
\setlength{\absrightindent}{25mm}
\renewcommand{\abstracttextfont}{\normalfont\large}


\usepackage{graphicx}
\usepackage{subfig}
\usepackage{svg}
\graphicspath{{resources/}}

\usepackage[affil-it]{authblk}


\usepackage[
  backend=biber,
  sorting=none
]{biblatex}
\renewcommand*{\nameyeardelim}{\addcomma\space}

%% @software ~> @online
% \DeclareBibliographyAlias{software}{online}

%% decrease URL font size in bibliography
\AtBeginBibliography{\renewcommand{\UrlFont}{\ttfamily\footnotesize}}

\addbibresource{references.bib}



\usepackage[font=footnotesize,labelfont=bf]{caption}

\setlength{\abovecaptionskip}{5pt plus 1pt minus 1pt}
\setlength{\belowcaptionskip}{5pt plus 1pt minus 1pt}


\usepackage{enumitem}
\usepackage{pifont}

\newlist{todolist}{itemize}{2}
\setlist[todolist]{label=\( \square \)}
\newcommand{\cmark}{\ding{51}}
\newcommand{\xmark}{\ding{55}}
\newcommand{\done}{\rlap{\( \square \)}{\raisebox{1.5pt}{\large\hspace{1.5pt}\cmark}}\hspace{-2.5pt}}


\usepackage[margin=20mm]{geometry}
\linespread{1.15}


\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{
  colorlinks,
  linkcolor={red!50!black},
  citecolor={red!50!black},
  urlcolor={blue!50!black}
}


\usepackage{booktabs}
\usepackage{flafter}

\renewcommand{\arraystretch}{1.2}

\makeatletter
\renewcommand{\fps@figure}{htp}
\renewcommand{\fps@table}{htp}
\makeatother

\usepackage{keystroke}

\usepackage{listings}
\usepackage[minted, most]{tcolorbox}
\tcbuselibrary{minted}
\tcbuselibrary{breakable}
\usepackage{minted}

\newcommand{\customfontsize}{\fontsize{8.5}{10.2}\selectfont}

\AtBeginDocument{  % need this since listings only defines its counter after \begin{document}
\newtcblisting[auto counter, number within = chapter]{haskell}
  { listing engine=minted
  , listing only
  , minted language=haskell
  , minted options=
      { fontsize=\customfontsize
      , autogobble
      , mathescape=true
      , escapeinside=||
      }
  , before skip=10pt
  , after skip=10pt
  , breakable
  }

\newtcblisting
  [ auto counter
  , number within = chapter
  , crefname={listing}{listings}
  , Crefname={listings}{Listings}
  , blend into=listings
  ]{haskellfloat}[2]
  { listing engine=minted
  , listing only
  , blend before title=colon
  , minted language=haskell
  , minted options=
      { fontsize=\customfontsize
      , autogobble
      , mathescape=true
      }
  , before skip=10pt
  , after skip=10pt
  , breakable
  , float
  , floatplacement=htp
  , title={#1}
  , label={code:#2}
  }

\newtcblisting
  [ use counter from = haskellfloat
  , crefname={listing}{listings}
  , Crefname={listings}{Listings}
  , blend into=listings
  ]{pythonfloat}[2]
  { listing engine=minted
  , listing only
  , blend before title=colon
  , minted language=python
  , minted options=
      { linenos
      , breaklines=true
      , fontsize=\customfontsize
      , autogobble
      , mathescape=true
      , escapeinside=||
      }
  , before skip=10pt
  , after skip=10pt
  , breakable
  , float
  , floatplacement=htp
  , title={#1}
  , label={code:#2}
  }

\newtcblisting
  [ use counter from = haskellfloat
  , crefname={listing}{listings}
  , Crefname={listings}{Listings}
  , blend into=listings
  ]{myminted}[2]
  {%
  listing engine=minted,
  minted language=isabelle,
  listing only,
  blend before title=colon,
  breakable,
  enhanced,
  minted options = {
      linenos,
      breaklines=true,
      breakbefore=.,
      %fontsize=\customfontsize,
      numbersep=2mm
      , autogobble
      , mathescape=true
      , escapeinside=||
  },
  overlay={%
      \begin{tcbclipinterior}
          \fill[gray!25] (frame.south west) rectangle ([xshift=4mm]frame.north west);
      \end{tcbclipinterior}
  }
  , before skip=10pt
  , after skip=10pt
  , breakable
  , float
  , floatplacement=htp
  , title={#1}
  , label={code:#2}
}

\newtcblisting
  [ use counter from = haskellfloat
  , crefname={listing}{listings}
  , Crefname={listings}{Listings}
  , blend into=listings
  ]{cfloat}[2]
  { listing engine=minted
  , listing only
  , blend before title=colon
  , minted language=c
  , minted options=
      { fontsize=\customfontsize
      , autogobble
      , mathescape=true
      , escapeinside=||
      }
  , before skip=10pt
  , after skip=10pt
  , breakable
  , float
  , floatplacement=htp
  , title={#1}
  , label={code:#2}
  }

\newtcblisting{customtext}
  { listing engine=minted
  , listing only
  , minted language=text
  , minted options={fontsize=\customfontsize, autogobble}
  , before skip=10pt
  , after skip=10pt
  , breakable
  }
} % end \AtBeginDocument

\definecolor{hackage}{RGB}{75, 139, 190}

\newtcbox{\hackagebox}
  { enhanced
  , nobeforeafter
  , tcbox raise base
  , boxrule=0.6pt
  , top=0mm, bottom=0mm, right=0mm, left=4mm, arc=1pt
  , boxsep=1.5pt
  , before upper={\vphantom{dlg}}
  , colframe=hackage!90!black
  , coltext=hackage!25!black
  , colback=hackage!10!white
  , overlay={
      \begin{tcbclipinterior}
        \fill[hackage] (frame.south west)
        rectangle node[] {\centering\includegraphics[width=5.3mm]{isabelle.pdf}}
        ([xshift=4mm]frame.north west);
      \end{tcbclipinterior}
    }
  }

\newcommand{\hackage}[1]{\hackagebox{\href{https://pypi.org/project/#1}{\color{hackage!25!black}{#1}}}}
\newcommand{\docs}[1]{\hackagebox{\href{https://isabelle.in.tum.de/}{\color{hackage!25!black}{#1}}}}
\newcommand{\isabelle}[0]{\hackagebox{\href{https://isabelle.in.tum.de/}{\color{hackage!25!black}Isabelle}}}
\newcommand{\inline}[1]{\mintinline{isabelle}{#1}}

\newcommand{\codeinlinenormal}[1]{\mintinline[fontsize=\footnotesize]{text}{#1}}
\newcommand{\codeinline}[1]{\mintinline[fontsize=\footnotesize]{text}{#1}}
\newcommand{\codeinlinesmall}[1]{\mintinline[fontsize=\scriptsize]{text}{#1}}


\makeatletter
\renewcommand\listoftables{%
  \section*{\listtablename}%
  \@mkboth{\MakeUppercase\listtablename}%
      {\MakeUppercase\listtablename}%
  \@starttoc{lot}%
}
\renewcommand\listoffigures{%
  \section*{\listfigurename}%
  \@mkboth{\MakeUppercase\listfigurename}%
      {\MakeUppercase\listfigurename}%
  \@starttoc{lof}%
}
\renewcommand\lstlistoflistings{%
  \section*{List of \lstlistlistingname}%
  \@mkboth{\MakeUppercase\lstlistlistingname}%
      {\MakeUppercase\lstlistlistingname}%
  \@starttoc{lol}%
}
\makeatother


\newcommand{\imgscaling}{0.8}
\newcommand{\customvertspacing}{0.5em}
\newcommand{\vertnegspacing}{0ex}
\newcommand{\customvertnegspacing}{0ex}
\newcommand{\aftertitlespacing}{1em}

\newcommand{\hd}{\rotatebox{60}}

\title{
  \vspace{\vertnegspacing}
  \rule{\textwidth}{1.5pt}\\[\customvertspacing]
  \huge Final Year Project Report\\[0.2em]
  \Large Formalising Alternative Models of Computation in Isabelle\\[\customvertspacing]
  \rule{\textwidth}{1.5pt}\\[\aftertitlespacing]
  \includegraphics[scale=\imgscaling]{Maynooth_Logo_English.pdf}
  \vspace{\customvertnegspacing}
}

\usepackage[nameinlink]{cleveref}

\frenchspacing
