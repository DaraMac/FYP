%
\begin{isabellebody}%
\setisabellecontext{Bounded{\isacharunderscore}TwoDim{\isacharunderscore}CA}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Bounded 2D Cellular Automata%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Bounded{\isacharunderscore}TwoDim{\isacharunderscore}CA\isanewline
\ \ \isakeyword{imports}\ Finite{\isacharunderscore}TwoDim{\isacharunderscore}CA{\isacharunderscore}Base\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{fun}\isamarkupfalse%
\ out{\isacharunderscore}of{\isacharunderscore}bounds\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}state\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}out{\isacharunderscore}of{\isacharunderscore}bounds\ s\ x\ y\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isasymge}\ int{\isacharunderscore}width\ s\ {\isasymor}\ x\ {\isacharless}\ {\isadigit{0}}\ {\isasymor}\ y\ {\isasymge}\ int{\isacharunderscore}height\ s\ {\isasymor}\ y\ {\isacharless}\ {\isadigit{0}}\ then\ True\ else\ False{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ get{\isacharunderscore}cell\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}state\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ cell{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}cell\ s\ x\ y\ {\isacharequal}\ {\isacharparenleft}if\ out{\isacharunderscore}of{\isacharunderscore}bounds\ s\ x\ y\ then\ Zero\ else\ \ s{\isacharbang}{\isacharparenleft}nat\ x{\isacharparenright}{\isacharbang}{\isacharparenleft}nat\ y{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ get{\isacharunderscore}nbhd\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}state\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ int\ {\isasymRightarrow}\ neighbourhood{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}get{\isacharunderscore}nbhd\ s\ x\ y\ {\isacharequal}\ list{\isacharunderscore}to{\isacharunderscore}nb\ {\isacharbrackleft}get{\isacharunderscore}cell\ s\ {\isacharparenleft}x{\isacharplus}i{\isacharparenright}\ {\isacharparenleft}y{\isacharplus}j{\isacharparenright}{\isachardot}\ j\ {\isasymleftarrow}\ rev\ {\isacharbrackleft}{\isacharminus}{\isadigit{1}}{\isachardot}{\isachardot}{\isadigit{1}}{\isacharbrackright}{\isacharcomma}\ i\ {\isasymleftarrow}\ {\isacharbrackleft}{\isacharminus}{\isadigit{1}}{\isachardot}{\isachardot}{\isadigit{1}}{\isacharbrackright}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ nbhds\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}state\ {\isasymRightarrow}\ neighbourhood\ list\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}nbhds\ s\ {\isacharequal}\ {\isacharparenleft}let\ h\ {\isacharequal}\ {\isacharparenleft}int{\isacharunderscore}height\ s{\isacharparenright}{\isacharminus}{\isadigit{1}}\ in\ {\isacharparenleft}let\ w\ {\isacharequal}\ {\isacharparenleft}int{\isacharunderscore}width\ s{\isacharparenright}{\isacharminus}{\isadigit{1}}\ in\isanewline
\ {\isacharbrackleft}{\isacharbrackleft}get{\isacharunderscore}nbhd\ s\ x\ y{\isachardot}\ y\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}h{\isacharbrackright}{\isacharbrackright}{\isachardot}\ x\ {\isasymleftarrow}\ {\isacharbrackleft}{\isadigit{0}}{\isachardot}{\isachardot}w{\isacharbrackright}{\isacharbrackright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\ \isanewline
\isacommand{fun}\isamarkupfalse%
\ update{\isacharunderscore}CA\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}CA\ {\isasymRightarrow}\ CA{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}update{\isacharunderscore}CA\ {\isacharparenleft}CA\ s\ r{\isacharparenright}\ {\isacharequal}\ CA\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}\ xs{\isachardot}\ map\ r\ xs{\isacharparenright}\ {\isacharparenleft}nbhds\ s{\isacharparenright}{\isacharparenright}\ r{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ run{\isacharunderscore}t{\isacharunderscore}steps\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}CA\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ CA{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}run{\isacharunderscore}t{\isacharunderscore}steps\ ca\ n\ {\isacharequal}\ apply{\isacharunderscore}t{\isacharunderscore}times\ update{\isacharunderscore}CA\ ca\ n{\isachardoublequoteclose}\isanewline
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/College/CS460-Final_Year_Project/project/Bounded_TwoDim_CA.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%35=5%:%
%:%38=6%:%
%:%39=7%:%
%:%40=7%:%
%:%41=8%:%
%:%42=9%:%
%:%43=10%:%
%:%44=10%:%
%:%45=11%:%
%:%46=12%:%
%:%47=13%:%
%:%48=13%:%
%:%49=14%:%
%:%50=15%:%
%:%51=16%:%
%:%52=16%:%
%:%53=17%:%
%:%54=18%:%
%:%55=19%:%
%:%56=20%:%
%:%57=21%:%
%:%58=21%:%
%:%59=22%:%
%:%60=23%:%
%:%61=24%:%
%:%62=24%:%
%:%63=25%:%
%:%70=26%:%